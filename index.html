<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Apprendre les Hiragana</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 30px;
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .lesson-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .lesson-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .lesson-btn.active {
            background: #667eea;
            color: white;
        }

        .lesson-title {
            text-align: center;
            color: #764ba2;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: #667eea;
            border-radius: 10px;
            transition: width 0.3s;
        }

        .step-container {
            min-height: 400px;
        }

        .step-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #f8f9fa;
            border-radius: 12px;
            overflow: hidden;
        }

        th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }

        tr:last-child td {
            border-bottom: none;
        }

        .hiragana-char {
            font-size: 28px;
            color: #333;
        }

        .exception {
            color: #f44336;
            font-weight: 600;
        }

        .question-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
        }

        .japanese-display {
            font-size: 48px;
            color: #333;
            margin: 20px 0;
        }

        .question-text {
            font-size: 16px;
            color: #666;
            margin-bottom: 20px;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .option-btn {
            padding: 20px;
            font-size: 24px;
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-btn:hover {
            border-color: #667eea;
        }

        .option-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .option-btn.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .option-btn.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .feedback {
            padding: 15px;
            margin: 20px 0;
            border-radius: 10px;
            display: none;
            text-align: center;
        }

        .feedback.show {
            display: block;
        }

        .feedback.success {
            background: #c8e6c9;
            color: #2e7d32;
        }

        .feedback.error {
            background: #ffcdd2;
            color: #c62828;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .score-display {
            text-align: center;
            font-size: 18px;
            color: #667eea;
            font-weight: 600;
            margin-top: 20px;
        }

        .final-message {
            text-align: center;
            padding: 40px 20px;
        }

        .final-score {
            font-size: 48px;
            color: #667eea;
            margin: 20px 0;
        }

        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }

            .options {
                grid-template-columns: 1fr;
            }

            .japanese-display {
                font-size: 36px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ‡¯ðŸ‡µ Apprendre les Hiragana</h1>

        <div class="lesson-selector" id="lessonSelector"></div>

        <div class="lesson-title" id="lessonTitle"></div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>

        <div class="step-container" id="stepContainer"></div>

        <div class="feedback" id="feedback"></div>

        <div class="btn-group">
            <button class="btn btn-primary" id="nextBtn">Suivant</button>
        </div>

        <div class="score-display" id="scoreDisplay">Score : 0/8</div>
    </div>

    <script>
        const lessons = [
            {
                id: 1,
                title: "LeÃ§on 1 : Voyelles + K (a, i, u, e, o, ka, ki, ku, ke, ko)",
                hiragana: [
                    { char: 'ã‚', romaji: 'a', note: '' },
                    { char: 'ã„', romaji: 'i', note: '' },
                    { char: 'ã†', romaji: 'u', note: '' },
                    { char: 'ãˆ', romaji: 'e', note: '' },
                    { char: 'ãŠ', romaji: 'o', note: '' },
                    { char: 'ã‹', romaji: 'ka', note: '' },
                    { char: 'ã', romaji: 'ki', note: '' },
                    { char: 'ã', romaji: 'ku', note: '' },
                    { char: 'ã‘', romaji: 'ke', note: '' },
                    { char: 'ã“', romaji: 'ko', note: '' }
                ],
                exercises: [
                    { type: 'table', title: 'PrÃ©sentation des hiragana' },
                    { type: 'recognition', question: 'Quelle est la lecture de ce hiragana ?', hiragana: 'ã', options: ['ki', 'ka', 'ku', 'ke'], correct: 'ki' },
                    { type: 'recognition', question: 'Quelle est la lecture de ce hiragana ?', hiragana: 'ã†', options: ['u', 'o', 'a', 'i'], correct: 'u' },
                    { type: 'writing', question: 'Comment Ã©crit-on "ka" en hiragana ?', romaji: 'ka', options: ['ã‹', 'ã', 'ã', 'ã“'], correct: 'ã‹' },
                    { type: 'writing', question: 'Comment Ã©crit-on "e" en hiragana ?', romaji: 'e', options: ['ãˆ', 'ã„', 'ãŠ', 'ã‚'], correct: 'ãˆ' },
                    { type: 'word', question: 'Que signifie ce mot ?', word: 'ã‚ã', meaning: 'automne', options: ['automne', 'printemps', 'Ã©tÃ©', 'hiver'], correct: 'automne' },
                    { type: 'word', question: 'Que signifie ce mot ?', word: 'ã„ãˆ', meaning: 'maison', options: ['maison', 'chat', 'chien', 'arbre'], correct: 'maison' },
                    { type: 'word', question: 'Que signifie ce mot ?', word: 'ã‹ãŠ', meaning: 'visage', options: ['visage', 'main', 'pied', 'tÃªte'], correct: 'visage' }
                ]
            },
            {
                id: 2,
                title: "LeÃ§on 2 : S + T (sa, shi, su, se, so, ta, chi, tsu, te, to)",
                hiragana: [
                    { char: 'ã•', romaji: 'sa', note: '' },
                    { char: 'ã—', romaji: 'shi', note: 'âš ï¸ shi (pas "si")' },
                    { char: 'ã™', romaji: 'su', note: '' },
                    { char: 'ã›', romaji: 'se', note: '' },
                    { char: 'ã', romaji: 'so', note: '' },
                    { char: 'ãŸ', romaji: 'ta', note: '' },
                    { char: 'ã¡', romaji: 'chi', note: 'âš ï¸ chi (pas "ti")' },
                    { char: 'ã¤', romaji: 'tsu', note: 'âš ï¸ tsu (pas "tu")' },
                    { char: 'ã¦', romaji: 'te', note: '' },
                    { char: 'ã¨', romaji: 'to', note: '' }
                ],
                exercises: [
                    { type: 'table', title: 'PrÃ©sentation des hiragana' },
                    { type: 'recognition', question: 'Quelle est la lecture de ce hiragana ?', hiragana: 'ã—', options: ['shi', 'si', 'chi', 'su'], correct: 'shi' },
                    { type: 'recognition', question: 'Quelle est la lecture de ce hiragana ?', hiragana: 'ã¡', options: ['chi', 'ti', 'shi', 'tsu'], correct: 'chi' },
                    { type: 'recognition', question: 'Quelle est la lecture de ce hiragana ?', hiragana: 'ã¤', options: ['tsu', 'tu', 'su', 'chi'], correct: 'tsu' },
                    { type: 'writing', question: 'Comment Ã©crit-on "shi" en hiragana ?', romaji: 'shi', options: ['ã—', 'ã¡', 'ã•', 'ã™'], correct: 'ã—' },
                    { type: 'writing', question: 'Comment Ã©crit-on "te" en hiragana ?', romaji: 'te', options: ['ã¦', 'ãŸ', 'ã¨', 'ã¡'], correct: 'ã¦' },
                    { type: 'word', question: 'Que signifie ce mot ?', word: 'ã™ã—', meaning: 'sushi', options: ['sushi', 'sakÃ©', 'soupe', 'thÃ©'], correct: 'sushi' },
                    { type: 'word', question: 'Que signifie ce mot ?', word: 'ã¦', meaning: 'main', options: ['main', 'pied', 'tÃªte', 'corps'], correct: 'main' }
                ]
            },
            {
                id: 3,
                title: "LeÃ§on 3 : N + H (na, ni, nu, ne, no, ha, hi, fu, he, ho)",
                hiragana: [
                    { char: 'ãª', romaji: 'na', note: '' },
                    { char: 'ã«', romaji: 'ni', note: '' },
                    { char: 'ã¬', romaji: 'nu', note: '' },
                    { char: 'ã­', romaji: 'ne', note: '' },
                    { char: 'ã®', romaji: 'no', note: '' },
                    { char: 'ã¯', romaji: 'ha', note: '' },
                    { char: 'ã²', romaji: 'hi', note: '' },
                    { char: 'ãµ', romaji: 'fu', note: 'âš ï¸ fu (pas "hu")' },
                    { char: 'ã¸', romaji: 'he', note: '' },
                    { char: 'ã»', romaji: 'ho', note: '' }
                ],
                exercises: [
                    { type: 'table', title: 'PrÃ©sentation des hiragana' },
                    { type: 'recognition', question: 'Quelle est la lecture de ce hiragana ?', hiragana: 'ãµ', options: ['fu', 'hu', 'ha', 'ho'], correct: 'fu' },
                    { type: 'recognition', question: 'Quelle est la lecture de ce hiragana ?', hiragana: 'ã­', options: ['ne', 'nu', 'na', 'no'], correct: 'ne' },
                    { type: 'writing', question: 'Comment Ã©crit-on "ni" en hiragana ?', romaji: 'ni', options: ['ã«', 'ãª', 'ã®', 'ã¬'], correct: 'ã«' },
                    { type: 'writing', question: 'Comment Ã©crit-on "ho" en hiragana ?', romaji: 'ho', options: ['ã»', 'ã¯', 'ã²', 'ã¸'], correct: 'ã»' },
                    { type: 'word', question: 'Que signifie ce mot ?', word: 'ã¯ãª', meaning: 'fleur', options: ['fleur', 'arbre', 'herbe', 'feuille'], correct: 'fleur' },
                    { type: 'word', question: 'Que signifie ce mot ?', word: 'ã­ã“', meaning: 'chat', options: ['chat', 'chien', 'oiseau', 'poisson'], correct: 'chat' },
                    { type: 'word', question: 'Que signifie ce mot ?', word: 'ã»ã‚“', meaning: 'livre', options: ['livre', 'stylo', 'papier', 'table'], correct: 'livre' }
                ]
            }
        ];

        let currentLessonIndex = 0;
        let currentExercise = 0;
        let score = 0;
        let answered = false;

        const stepContainer = document.getElementById('stepContainer');
        const feedback = document.getElementById('feedback');
        const nextBtn = document.getElementById('nextBtn');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const progressBar = document.getElementById('progressBar');
        const lessonTitle = document.getElementById('lessonTitle');
        const lessonSelector = document.getElementById('lessonSelector');

        function init() {
            renderLessonSelector();
            loadLesson(0);
        }

        function renderLessonSelector() {
            lessonSelector.innerHTML = '';
            lessons.forEach((lesson, index) => {
                const btn = document.createElement('button');
                btn.className = 'lesson-btn' + (index === currentLessonIndex ? ' active' : '');
                btn.textContent = `LeÃ§on ${lesson.id}`;
                btn.onclick = () => loadLesson(index);
                lessonSelector.appendChild(btn);
            });
        }

        function loadLesson(index) {
            currentLessonIndex = index;
            currentExercise = 0;
            score = 0;
            answered = false;
            const lesson = lessons[currentLessonIndex];
            lessonTitle.textContent = lesson.title;
            scoreDisplay.textContent = `Score : 0/${lesson.exercises.length - 1}`;
            renderLessonSelector();
            renderExercise();
            updateProgress();
        }

        function updateProgress() {
            const lesson = lessons[currentLessonIndex];
            const progress = ((currentExercise + 1) / lesson.exercises.length) * 100;
            progressBar.style.width = progress + '%';
        }

        function renderExercise() {
            const lesson = lessons[currentLessonIndex];
            const exercise = lesson.exercises[currentExercise];
            stepContainer.innerHTML = '';
            feedback.className = 'feedback';
            answered = false;

            const title = document.createElement('div');
            title.className = 'step-title';
            title.textContent = exercise.title || `Exercice ${currentExercise}`;
            stepContainer.appendChild(title);

            if (exercise.type === 'table') {
                renderTable(lesson.hiragana);
            } else if (exercise.type === 'recognition') {
                renderRecognition(exercise);
            } else if (exercise.type === 'writing') {
                renderWriting(exercise);
            } else if (exercise.type === 'word') {
                renderWord(exercise);
            }

            nextBtn.disabled = exercise.type !== 'table';
        }

        function renderTable(hiragana) {
            const table = document.createElement('table');
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>Hiragana</th>
                        <th>Romaji</th>
                        <th>Note</th>
                    </tr>
                </thead>
                <tbody>
                    ${hiragana.map(h => `
                        <tr>
                            <td class="hiragana-char">${h.char}</td>
                            <td><strong>${h.romaji}</strong></td>
                            <td${h.note.includes('âš ï¸') ? ' class="exception"' : ''}>${h.note || '-'}</td>
                        </tr>
                    `).join('')}
                </tbody>
            `;
            stepContainer.appendChild(table);
        }

        function renderRecognition(exercise) {
            const box = document.createElement('div');
            box.className = 'question-box';

            const display = document.createElement('div');
            display.className = 'japanese-display';
            display.textContent = exercise.hiragana;
            box.appendChild(display);

            const question = document.createElement('div');
            question.className = 'question-text';
            question.textContent = exercise.question;
            box.appendChild(question);

            stepContainer.appendChild(box);

            renderOptions(exercise.options, exercise.correct);
        }

        function renderWriting(exercise) {
            const box = document.createElement('div');
            box.className = 'question-box';

            const question = document.createElement('div');
            question.className = 'question-text';
            question.textContent = exercise.question;
            box.appendChild(question);

            const display = document.createElement('div');
            display.className = 'japanese-display';
            display.style.fontSize = '32px';
            display.textContent = exercise.romaji;
            box.appendChild(display);

            stepContainer.appendChild(box);

            renderOptions(exercise.options, exercise.correct);
        }

        function renderWord(exercise) {
            const box = document.createElement('div');
            box.className = 'question-box';

            const display = document.createElement('div');
            display.className = 'japanese-display';
            display.textContent = exercise.word;
            box.appendChild(display);

            const question = document.createElement('div');
            question.className = 'question-text';
            question.textContent = exercise.question;
            box.appendChild(question);

            stepContainer.appendChild(box);

            renderOptions(exercise.options, exercise.correct);
        }

        function renderOptions(options, correct) {
            const shuffled = shuffleArray([...options]);
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options';

            shuffled.forEach(option => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = option;
                btn.onclick = () => selectOption(btn, option, correct);
                optionsDiv.appendChild(btn);
            });

            stepContainer.appendChild(optionsDiv);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function selectOption(button, selected, correct) {
            if (answered) return;

            const allButtons = stepContainer.querySelectorAll('.option-btn');
            allButtons.forEach(btn => {
                btn.onclick = null;
                if (btn.textContent === correct) {
                    btn.classList.add('correct');
                } else if (btn === button) {
                    btn.classList.add('incorrect');
                }
            });

            answered = true;
            const isCorrect = selected === correct;

            if (isCorrect) {
                score++;
                feedback.className = 'feedback success show';
                feedback.textContent = 'âœ“ Correct !';
            } else {
                feedback.className = 'feedback error show';
                feedback.textContent = `âœ— Incorrect. La bonne rÃ©ponse Ã©tait : ${correct}`;
            }

            updateScore();
            nextBtn.disabled = false;
        }

        function updateScore() {
            const lesson = lessons[currentLessonIndex];
            scoreDisplay.textContent = `Score : ${score}/${lesson.exercises.length - 1}`;
        }

        nextBtn.addEventListener('click', () => {
            const lesson = lessons[currentLessonIndex];

            if (currentExercise < lesson.exercises.length - 1) {
                currentExercise++;
                renderExercise();
                updateProgress();
            } else {
                showFinalScore();
            }
        });

        function showFinalScore() {
            const lesson = lessons[currentLessonIndex];
            const total = lesson.exercises.length - 1;
            const percentage = Math.round((score / total) * 100);

            stepContainer.innerHTML = `
                <div class="final-message">
                    <div class="step-title">LeÃ§on ${lesson.id} terminÃ©e</div>
                    <div class="final-score">${score}/${total}</div>
                    <div class="question-text">${percentage}% de rÃ©ussite</div>
                    <button class="btn btn-primary" onclick="loadLesson(${currentLessonIndex})" style="margin: 10px; width: 200px;">
                        Recommencer
                    </button>
                    ${currentLessonIndex < lessons.length - 1 ? `
                        <button class="btn btn-primary" onclick="loadLesson(${currentLessonIndex + 1})" style="margin: 10px; width: 200px;">
                            LeÃ§on suivante â†’
                        </button>
                    ` : ''}
                </div>
            `;
            nextBtn.style.display = 'none';
            feedback.className = 'feedback';
        }

        init();
    </script>
</body>
</html>
